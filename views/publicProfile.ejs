<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= profile.businessName || profile.name %> - BNI Profile</title>
  <meta property="og:title" content="<%= profile.businessName || profile.name %>">
  <meta property="og:description" content="<%= profile.aboutBusiness || profile.introductionDetails %>">
  <% if (profile.profilePic) { %>
    <meta property="og:image" content="<%= profile.profilePic %>">
  <% } %>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
      margin: 0;
      padding: 0;
    }
    .profile-container {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .profile-container:hover {
      transform: translateY(-5px);
      box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    }
    .profile-image {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }
    .profile-image:hover {
      transform: scale(1.05);
      box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
    }
    .category-badge {
      transition: background-color 0.3s ease, transform 0.3s ease;
    }
    .category-badge:hover {
      background-color: #7c3aed;
      color: white;
      transform: translateY(-2px);
    }
    .info-item {
      transition: background-color 0.3s ease;
    }
    .info-item:hover {
      background-color: #f3e8ff;
      border-radius: 8px;
      padding: 8px;
    }
    .profile-section h3 {
      position: relative;
      display: inline-block;
    }
    .profile-section h3::after {
      content: '';
      position: absolute;
      bottom: -4px;
      left: 0;
      width: 50%;
      height: 3px;
      background: linear-gradient(to right, #8b5cf6, #ec4899);
      border-radius: 2px;
    }
    .no-image-placeholder {
      transition: background-color 0.3s ease;
    }
    .no-image-placeholder:hover {
      background-color: #d1d5db;
    }
  </style>
</head>
<body>
  <div class="profile-container max-w-4xl mx-auto my-10 p-8 bg-white rounded-2xl shadow-lg">
    <% if (profile.businessBanner) { %>
      <img src="<%= profile.businessBanner %>" class="profile-banner w-full h-64 object-cover rounded-lg mb-6" alt="Banner" onerror="this.style.display='none'">
    <% } %>
    
    <div class="profile-header text-center mb-10">
      <img src="<%= profile.profilePic %>" class="profile-image w-36 h-36 rounded-full object-cover mx-auto border-4 border-white shadow-md bg-gray-100" alt="Profile" 
        onerror="this.onerror=null; this.style.display='none'; 
        document.getElementById('image-placeholder').style.display='block';">
      <div id="image-placeholder" class="no-image-placeholder w-36 h-36 rounded-full bg-gray-200 text-gray-600 text-4xl flex items-center justify-center mx-auto border-4 border-white shadow-md" style="display:none;">
        <%= profile.name.charAt(0).toUpperCase() %>
      </div>
      
      <h1 class="profile-name text-3xl font-bold text-gray-800 mt-4"><%= profile.name %></h1>
      <% if (profile.meetingRole) { %>
        <p class="text-lg text-gray-600"><strong class="text-purple-600">Meeting Role:</strong> <%= profile.meetingRole %></p>
      <% } %>
      <% if (profile.chapterName) { %>
        <p class="text-lg text-gray-600"><strong class="text-purple-600">Chapter:</strong> <%= profile.chapterName %></p>
      <% } %>
      <% if (profile.businessName) { %>
        <h2 class="profile-business text-2xl font-semibold text-gray-700 mt-2"><%= profile.businessName %></h2>
      <% } %>
    </div>

    <% if (profile.introductionDetails) { %>
      <div class="profile-section mb-8">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Introduction</h3>
        <p class="text-gray-600 leading-relaxed"><%= profile.introductionDetails %></p>
      </div>
    <% } %>

    <% if (profile.businessName || profile.businessType || profile.category) { %>
      <div class="profile-section mb-8">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Business Information</h3>
        <div class="info-grid grid grid-cols-1 md:grid-cols-2 gap-4">
          <% if (profile.businessName) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Business Name:</span>
              <span class="text-gray-600"><%= profile.businessName %></span>
            </div>
          <% } %>
          <% if (profile.businessType) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Business Type:</span>
              <span class="text-gray-600"><%= profile.businessType %></span>
            </div>
          <% } %>
          <% if (profile.category) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Category:</span>
              <span class="text-gray-600"><%= profile.category %></span>
            </div>
          <% } %>
          <% if (profile.subCategory) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Sub Category:</span>
              <span class="text-gray-600"><%= profile.subCategory %></span>
            </div>
          <% } %>
          <% if (profile.products) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Products:</span>
              <span class="text-gray-600"><%= profile.products %></span>
            </div>
          <% } %>
          <% if (profile.services) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Services:</span>
              <span class="text-gray-600"><%= profile.services %></span>
            </div>
          <% } %>
          <% if (profile.website) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Website:</span>
              <a href="<%= profile.website %>" target="_blank" class="text-purple-500 hover:text-purple-700 transition-colors"><%= profile.website %></a>
            </div>
          <% } %>
        </div>
      </div>
    <% } %>

    <% if (profile.aboutBusiness) { %>
      <div class="profile-section mb-8">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">About the Business</h3>
        <p class="text-gray-600 leading-relaxed"><%= profile.aboutBusiness %></p>
      </div>
    <% } %>

    <% if (Object.keys(profile.bioDetails).length > 0) { %>
      <div class="profile-section mb-8">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Bio Details</h3>
        <div class="info-grid grid grid-cols-1 md:grid-cols-2 gap-4">
          <% if (profile.bioDetails.yearsInBusiness) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Years in Business:</span>
              <span class="text-gray-600"><%= profile.bioDetails.yearsInBusiness %></span>
            </div>
          <% } %>
          <% if (profile.bioDetails.spouse) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Spouse:</span>
              <span class="text-gray-600"><%= profile.bioDetails.spouse %></span>
            </div>
          <% } %>
          <% if (profile.bioDetails.children) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Children:</span>
              <span class="text-gray-600"><%= profile.bioDetails.children %></span>
            </div>
          <% } %>
          <% if (profile.bioDetails.hobbies) { %>
            <div class="info-item">
              <span class="info-label font-semibold text-purple-600">Hobbies:</span>
              <span class="text-gray-600"><%= profile.bioDetails.hobbies %></span>
            </div>
          <% } %>
        </div>
      </div>
    <% } %>

    <% if (profile.topProfile.idealReferral) { %>
      <div class="profile-section mb-8">
        <h3 class="text-xl font-semibold text-gray-800 mb-4">Ideal Referral</h3>
        <p class="text-gray-600 leading-relaxed"><%= profile.topProfile.idealReferral %></p>
      </div>
    <% } %>
  </div>

  <script>
    // Log image loading errors to console for debugging
    document.addEventListener('DOMContentLoaded', function() {
      const images = document.querySelectorAll('img');
      images.forEach(img => {
        img.addEventListener('error', function() {
          console.error('Failed to load image:', this.src);
        });
      });
    });
  </script>
</body>
</html>